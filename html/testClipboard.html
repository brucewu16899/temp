<html>
<head><title>test clipboard</title>
<style>
  body {font-size:9pt;margin:5pt;}
  th, td {font-size:9pt;}
</style>
</head>

<body>
<script language="JavaScript">
function fnTest() {
    oMsg.innerText = window.clipboardData.getData("Text");
}

function fnBeforeCopy() {
    oMsg.innerText = document.selection.createRange().text;
}

function fnCopyIt() {
    oControlRange = document.body.createControlRange();
    oControlRange.add(oImg);
    oControlRange.execCommand("copy");
}
</script>

<div id="oSource" onbeforecopy="fnBeforeCopy()">
    source text
</div>
<br>
<input type="button" value="paste from clipboard" onclick="fnTest()">
<pre id="oMsg">
</pre>

<img id="oImg" src="http://zi.csdn.net/120.60_4.gif">
<button onclick="fnCopyIt()">fnCopyIt()</button>

</body>
</html>
